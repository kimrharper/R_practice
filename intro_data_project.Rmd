---
title: "Exploring the BRFSS data"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---

## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
library(Rgraphviz)
```

### Load data

Make sure your data and R Markdown files are in the same directory. When loaded
your data file will be called `brfss2013`. Delete this note when before you submit 
your work. 

```{r load-data}
load("brfss2013.RData")
```



* * *

## Part 1: Data

Import and filter the data to only include important features.

```{r}
orig_dim <- dim(brfss2013)
weight_diabetes <- brfss2013 %>%
   select(sex, weight2,diabete3)
new_dim <- dim(weight_diabetes)

sprintf("Original Dimensions: [%s]x[%s]  New Dimensions: [%s]x[%s]", orig_dim[1],orig_dim[2],new_dim[1],new_dim[2])
```
Vector has been reduced to 3 dimensions, but it still needs to be cleaned.

```{r}
weight_diabetes[weight_diabetes == ""] <- NA
weight_diabetes <- na.omit(weight_diabetes)
head(weight_diabetes, n=10)
```

* * *

## Part 2: Research questions

**Research quesion 1:**<br>
What are the distributions of the updated data set: sex, weight, diabete3?<br><br>
**Research quesion 2:**<br>
What is the probability that a participant is heavy (weight > 200) if they are male?<br><br>
**Research quesion 3:**<br>
What is the probability that a participant has diabetes if they are male and heavy (weight > 200)?<br>

__Assumption:__ _The feature 'diabete3' is a survey question asking the participant whether or not they know they have diabetes. I will be interpreting the response of this survey question to be either a positive or negative diagnosis on diabetes, but in actuality data will reflect the respondants' awareness of whether or not they have diabetes._



* * *

## Part 3: Exploratory data analysis

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button (green button with orange arrow) above. Make sure that your code is visible
in the project you submit. Delete this note when before you submit your work.

**Research quesion 1:**

```{r}

```



**Research quesion 2:**

```{r}

```



**Research quesion 3:**

```{r}

```


## Part 4: Conclusion

```{r}
# Example code by: http://www.harrysurden.com/wordpress/archives/292
# R Conditional Probability Tree Diagram
 
# The Rgraphviz graphing package must be installed to do this
require("Rgraphviz")
 
# Change the three variables below to match your actual values
# These are the values that you can change for your own probability tree
# From these three values, other probabilities (e.g. prob(b)) will be calculated 
 
# Probability of a
a<-.01
 
# Probability (b | a)
bGivena<-.99
 
# Probability (b | Â¬a)
bGivenNota<-.10
 
###################### Everything below here will be calculated
 
# Calculate the rest of the values based upon the 3 variables above
notbGivena<-1-bGivena
notA<-1-a
notbGivenNota<-1-bGivenNota
 
#Joint Probabilities of a and B, a and notb, nota and b, nota and notb
aANDb<-a*bGivena
aANDnotb<-a*notbGivena
notaANDb <- notA*bGivenNota
notaANDnotb <- notA*notbGivenNota
 
# Probability of B
b<- aANDb + notaANDb
notB <- 1-b
 
# Bayes theorum - probabiliyt of A | B
# (a | b) = Prob (a AND b) / prob (b)
aGivenb <- aANDb / b
 
# These are the labels of the nodes on the graph
# To signify "Not A" - we use A' or A prime 
 
node1<-"G"
node2<-"W"
node3<-"W'"
node4<-"W&D"
node5<-"W&D'"
node6<-"W'&D"
node7<-"W'&D'"
nodeNames<-c(node1,node2,node3,node4, node5,node6, node7)
 
rEG <- new("graphNEL", nodes=nodeNames, edgemode="directed")

 
# Draw the "lines" or "branches" of the probability Tree
rEG <- addEdge(nodeNames[1], nodeNames[2], rEG, 1)
rEG <- addEdge(nodeNames[1], nodeNames[3], rEG, 1)
rEG <- addEdge(nodeNames[2], nodeNames[4], rEG, 1)
rEG <- addEdge(nodeNames[2], nodeNames[5], rEG, 1)
rEG <- addEdge(nodeNames[3], nodeNames[6], rEG, 1)
rEG <- addEdge(nodeNames[3], nodeNames[7], rEG, 10)
 
eAttrs <- list()
 
q<-edgeNames(rEG)
 



# Add the probability values to the the branch lines
 
eAttrs$label <- c(toString(a),toString(notA),
 toString(bGivena), toString(notbGivena),
 toString(bGivenNota), toString(notbGivenNota))
names(eAttrs$label) <- c(q[1],q[2], q[3], q[4], q[5], q[6])
edgeAttrs<-eAttrs
 
# Set the color, etc, of the tree
attributes<-list(node=list(label="foo", fillcolor="lightgreen", fontsize="15"),
 edge=list(color="red"),graph=list(rankdir="LR"))
 
#Plot the probability tree using Rgraphvis
plot(rEG, edgeAttrs=eAttrs, attrs=attributes)
#nodes(rEG)
#edges(rEG)
 
#Add the probability values to the leaves of A&B, A&B', A'&B, A'&B'
text(500,420,aANDb, cex=.8)
 
text(500,280,aANDnotb,cex=.8)
 
text(500,160,notaANDb,cex=.8)
 
text(500,30,notaANDnotb,cex=.8)
 
text(340,440,"(B | A)",cex=.8)
 
text(340,230,"(B | A')",cex=.8)
 
#Write a table in the lower left of the probablites of A and B
text(80,50,paste("P(A):",a),cex=.9, col="darkgreen")
text(80,20,paste("P(A'):",notA),cex=.9, col="darkgreen")
 
text(160,50,paste("P(B):",round(b,digits=2)),cex=.9)
text(160,20,paste("P(B'):",round(notB, 2)),cex=.9)
 
text(80,420,paste("P(A|B): ",round(aGivenb,digits=2)),cex=.9,col="blue")

```